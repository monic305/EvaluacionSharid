<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>GlowBeauty - Panel Profesional</title>
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
	<link rel="stylesheet" th:href="@{/css/stylesprofe.css}">
</head>

<body data-theme="light">
	<!-- Custom Alert -->
	<div id="customAlert" class="custom-alert">
		<i class="fas fa-check-circle alert-icon"></i>
		<p id="alertMessage"></p>
	</div>

	<!-- Reschedule Modal -->
	<div id="rescheduleModal" class="modal">
		<div class="modal-content">
			<div class="modal-header">
				<h2 class="modal-title">Reprogramar Cita</h2>
				<button class="close-modal" onclick="closeModal('rescheduleModal')">&times;</button>
			</div>
			<form id="rescheduleForm" th:action="@{/profesional/reprogramar-cita}" method="post">
				<input type="hidden" id="rescheduleIdModal" name="citaId">
				<div class="form-group">
					<label>Nueva Fecha</label>
					<input type="date" id="newAppointmentDate" name="fecha" required>
				</div>
				<div class="form-group">
					<label>Nueva Hora</label>
					<select name="hora" id="newAppointmentTime" required>
						<option value="">-- Selecciona una hora --</option>
						<option value="09:00">09:00 AM</option>
						<option value="09:30">09:30 AM</option>
						<option value="10:00">10:00 AM</option>
						<option value="10:30">10:30 AM</option>
						<option value="11:00">11:00 AM</option>
						<option value="11:30">11:30 AM</option>
						<option value="12:00">12:00 PM</option>
						<option value="12:30">12:30 PM</option>
						<option value="14:00">02:00 PM</option>
						<option value="14:30">02:30 PM</option>
						<option value="15:00">03:00 PM</option>
						<option value="15:30">03:30 PM</option>
						<option value="16:00">04:00 PM</option>
						<option value="16:30">04:30 PM</option>
						<option value="17:00">05:00 PM</option>
						<option value="17:30">05:30 PM</option>
						<option value="18:00">06:00 PM</option>
					</select>
				</div>
				<button type="submit" class="btn btn-primary">Confirmar Reprogramaci贸n</button>
			</form>
		</div>
	</div>

	<!-- Service Modal -->
	<div id="serviceModal" class="modal">
		<div class="modal-content">
			<div class="modal-header">
				<h2 class="modal-title" id="serviceModalTitle">Crear Servicio</h2>
				<button class="close-modal" onclick="closeModal('serviceModal')">&times;</button>
			</div>
			<form id="serviceForm" th:action="@{/profesional/crear-servicio}" method="post">
				<input type="hidden" id="serviceIdModal" name="id">
				<div class="form-group">
					<label>Nombre del Servicio</label>
					<input type="text" id="serviceName" name="nombre" placeholder="Ej: Corte de Cabello" required>
				</div>
				<div class="form-group">
					<label>Descripci贸n</label>
					<textarea id="serviceDescription" name="descripcion" rows="3" placeholder="Describe tu servicio..."
						required></textarea>
				</div>
				<div class="form-group">
					<label>Precio</label>
					<input type="number" id="servicePrice" name="precio" placeholder="Ej: 30000" required>
				</div>
				<div class="form-group">
					<label>Duraci贸n</label>
					<input type="text" id="serviceDuration" name="duracion" placeholder="Ej: 60 min" required>
				</div>
				<button type="submit" class="btn btn-primary">Guardar Servicio</button>
			</form>
		</div>
	</div>



	<!-- Navigation -->
	<nav>
		<div class="nav-container">
			<div class="logo" onclick="showSection('dashboard')">
				<i class="fas fa-scissors"></i> GlowBeauty Beauty
			</div>
			<ul class="nav-links">
				<li><a onclick="showSection('dashboard')">Dashboard</a></li>
				<li><a onclick="showSection('appointments')">Citas</a></li>
				<li><a onclick="showSection('services')">Servicios</a></li>
				<li><a onclick="showSection('profile')">Mi Perfil</a></li>
				<li>
					<button class="theme-toggle" onclick="toggleTheme()">
						<i class="fas fa-moon" id="themeIcon"></i>
					</button>
				</li>
				<li class="user-menu">
					<div class="user-avatar" id="userAvatar" onclick="toggleUserDropdown()">
						<span
							th:text="${nombreUsuario != null ? nombreUsuario.substring(0,1).toUpperCase() : 'P'}">P</span>
					</div>
					<div class="user-dropdown" id="userDropdown">
						<a th:href="@{/logout}">Cerrar Sesi贸n</a>
					</div>
				</li>
			</ul>
		</div>
	</nav>

	<!-- Hidden data for JavaScript -->
	<input type="hidden" id="usuarioId" th:value="${usuarioId}">
	<input type="hidden" id="profesionalId" th:value="${profesionalId}">
	<input type="hidden" id="nombreUsuario" th:value="${nombreUsuario}">

	<!-- Main Content -->
	<main>
		<!-- Alertas -->
		<div th:if="${success}" class="alert alert-success"
			style="margin: 1rem auto; max-width: 1200px; padding: 1rem; background: #10b981; color: white; border-radius: 8px; text-align: center;">
			<span th:text="${success}"></span>
		</div>
		<div th:if="${error}" class="alert alert-error"
			style="margin: 1rem auto; max-width: 1200px; padding: 1rem; background: #ef4444; color: white; border-radius: 8px; text-align: center;">
			<span th:text="${error}"></span>
		</div>

		<!-- Dashboard Section -->
		<section id="dashboard" class="section active">
			<div class="dashboard-header">
				<h1>Panel Profesional</h1>
				<p>Hola de nuevo, <span th:text="${nombreUsuario}">Profesional</span></p>
			</div>

			<!-- Stats -->
			<div class="stats-container">
				<div class="stat-card">
					<div class="stat-icon"><i class="fas fa-calendar-check"></i></div>
					<div class="stat-number" th:text="${estadisticas.citasHoy}">0</div>
					<div class="stat-label">Citas Hoy</div>
				</div>
				<div class="stat-card">
					<div class="stat-icon"><i class="fas fa-users"></i></div>
					<div class="stat-number" th:text="${estadisticas.citasSemana}">0</div>
					<div class="stat-label">Citas Esta Semana</div>
				</div>
				<div class="stat-card">
					<div class="stat-icon"><i class="fas fa-dollar-sign"></i></div>
					<div class="stat-number" th:text="${estadisticas.ingresosMes}">$0</div>
					<div class="stat-label">Ingresos del Mes</div>
				</div>
			</div>



			<div class="panel-grid">
				<div class="panel-card">
					<h3><i class="fas fa-calendar-day"></i> Pr贸ximas Citas</h3>
					<div id="professionalAppointments">
						<div th:if="${#lists.isEmpty(citas)}"
							style="text-align: center; padding: 2rem; color: var(--text-color); opacity: 0.7;">
							No tienes citas programadas
						</div>
						<div th:each="cita : ${citas}" class="appointment-item">
							<h4 th:text="${cita.usuario.nombre}">Cliente</h4>
							<p><strong>Servicio:</strong> <span th:text="${cita.servicio.nombre}">Servicio</span></p>
							<p><strong>Fecha:</strong> <span
									th:text="${#temporals.format(cita.fechaHora, 'dd/MM/yyyy')}">Fecha</span></p>
							<p><strong>Hora:</strong> <span
									th:text="${#temporals.format(cita.fechaHora, 'HH:mm')}">Hora</span></p>
							<p><strong>Estado:</strong>
								<span th:if="${cita.estado == 'pendiente'}" style="color: #f59e0b;">Pendiente</span>
								<span th:if="${cita.estado == 'confirmada'}" style="color: #10b981;">Confirmada</span>
							</p>
							<div class="appointment-actions">
								<form th:action="@{/profesional/cancelar-cita}" method="post" style="display: inline;"
									onsubmit="return confirm('驴Est谩s seguro de cancelar esta cita?');">
									<input type="hidden" name="citaId" th:value="${cita.id}">
									<button type="submit" class="btn btn-danger">Cancelar</button>
								</form>
								<button class="btn btn-warning"
									th:onclick="'openRescheduleModal(' + ${cita.id} + ')'">Reprogramar</button>
								<form th:action="@{/profesional/finalizar-cita}" method="post" style="display: inline;">
									<input type="hidden" name="citaId" th:value="${cita.id}">
									<button type="submit" class="btn btn-success">Finalizar</button>
								</form>
							</div>
						</div>
					</div>
				</div>
			</div>
		</section>




		<!-- Appointments Section -->
		<section id="appointments" class="section">
			<h1 class="section-title">Gesti贸n de Citas</h1>

			<div class="panel-grid">
				<div class="panel-card">
					<h3><i class="fas fa-calendar-alt"></i> Tus Citas</h3>
					<div id="citasProximasList">
						<div th:if="${#lists.isEmpty(citas)}"
							style="text-align: center; padding: 2rem; color: var(--text-color); opacity: 0.7;">
							No tienes citas programadas
						</div>
						<div th:each="cita : ${citas}" class="appointment-item">
							<h4 th:text="${cita.usuario.nombre}">Cliente</h4>
							<p><strong>Servicio:</strong> <span th:text="${cita.servicio.nombre}">Servicio</span></p>
							<p><strong>Fecha:</strong> <span
									th:text="${#temporals.format(cita.fechaHora, 'dd/MM/yyyy')}">Fecha</span></p>
							<p><strong>Hora:</strong> <span
									th:text="${#temporals.format(cita.fechaHora, 'HH:mm')}">Hora</span></p>
							<p><strong>Estado:</strong>
								<span th:if="${cita.estado == 'pendiente'}" style="color: #f59e0b;">Pendiente</span>
								<span th:if="${cita.estado == 'confirmada'}" style="color: #10b981;">Confirmada</span>
							</p>
							<div class="appointment-actions">
								<form th:action="@{/profesional/cancelar-cita}" method="post" style="display: inline;"
									onsubmit="return confirm('驴Est谩s seguro de cancelar esta cita?');">
									<input type="hidden" name="citaId" th:value="${cita.id}">
									<button type="submit" class="btn btn-danger">Cancelar</button>
								</form>
								<button class="btn btn-warning"
									th:onclick="'openRescheduleModal(' + ${cita.id} + ')'">Reprogramar</button>
								<form th:action="@{/profesional/finalizar-cita}" method="post" style="display: inline;">
									<input type="hidden" name="citaId" th:value="${cita.id}">
									<button type="submit" class="btn btn-success">Finalizar</button>
								</form>
							</div>
						</div>
					</div>
				</div>
			</div>
		</section>

		<!-- Services Section -->
		<section id="services" class="section">
			<h1 class="section-title">Mis Servicios</h1>

			<div class="panel-grid">
				<div class="panel-card">
					<h3><i class="fas fa-concierge-bell"></i> Servicios Ofrecidos</h3>
					<div class="services-management" id="serviciosList">
						<div th:if="${#lists.isEmpty(servicios)}"
							style="text-align: center; padding: 2rem; color: var(--text-color); opacity: 0.7;">
							No tienes servicios registrados
						</div>
						<div th:each="servicio : ${servicios}" class="service-item">
							<div class="service-info">
								<h4 th:text="${servicio.nombre}">Servicio</h4>
								<p th:text="${servicio.descripcion}">Descripci贸n</p>
								<p><strong>Precio:</strong> $<span th:text="${servicio.precio}">0</span> |
									<strong>Duraci贸n:</strong> <span th:text="${servicio.duracion}">0 min</span>
								</p>
							</div>
							<div class="service-actions">
								<button class="btn btn-primary" th:attr="data-id=${servicio.id},
								                 data-nombre=${servicio.nombre},
								                 data-descripcion=${servicio.descripcion},
								                 data-precio=${servicio.precio},
								                 data-duracion=${servicio.duracion}" onclick="editService(this)">
									Editar
								</button>
								<form th:action="@{/profesional/eliminar-servicio}" method="post"
									style="display:inline;"
									onsubmit="return confirm('驴Est谩s seguro de eliminar este servicio?');">
									<input type="hidden" name="id" th:value="${servicio.id}">
									<button type="submit" class="btn btn-danger">Eliminar</button>
								</form>
							</div>
						</div>
					</div>
					<button class="btn-full" style="margin-top: 1.5rem;" onclick="openServiceModal()">Agregar Nuevo
						Servicio</button>
				</div>
			</div>
		</section>

		<!-- Profile Section -->
		<section id="profile" class="section">
			<h1 class="section-title">Mi Perfil</h1>
			<div class="profile-container">
				<div class="profile-header">
					<div class="profile-avatar" id="profileAvatar"><i class="fas fa-user-md"></i></div>
					<h2 id="profileName" th:text="${nombreUsuario}">Profesional</h2>
					<p id="profileSpecialty" th:text="${especializacionProfesional}">Profesional</p>
				</div>

				<form th:action="@{/profesional/actualizar-perfil}" method="post">
					<input type="hidden" name="usuarioId" th:value="${usuarioId}">
					<input type="hidden" name="profesionalId" th:value="${profesionalId}">

					<div class="form-group">
						<label>Nombre completo</label>
						<input type="text" id="profileNameInput" name="nombre" placeholder="Tu nombre"
							th:value="${nombreUsuario}" required>
					</div>
					<div class="form-group">
						<label>Email</label>
						<input type="email" id="profileEmail" name="email" placeholder="tu@email.com"
							th:value="${emailUsuario}" required>
					</div>
					<div class="form-group">
						<label>Tel茅fono</label>
						<input type="tel" id="profilePhone" name="telefono" placeholder="+57 300 123 4567"
							th:value="${telefonoUsuario}" required>
					</div>
					<div class="form-group">
						<label>Especialidad</label>
						<input type="text" id="profileSpecialty" name="especialidad" placeholder="Tu especialidad"
							th:value="${especializacionProfesional}" required>
					</div>
					<button type="submit" class="btn-full">Actualizar Perfil</button>
				</form>

				<a th:href="@{/logout}" class="btn-full logout-btn"
					style="display: inline-block; text-align: center; text-decoration: none;">Cerrar Sesi贸n</a>

				<form th:action="@{/profesional/eliminar-cuenta}" method="post"
					onsubmit="return confirm('驴Est谩s seguro de eliminar tu cuenta?');">
					<input type="hidden" name="usuarioId" th:value="${usuarioId}">
					<input type="hidden" name="profesionalId" th:value="${profesionalId}">
					<button type="submit" class="btn-full delete-account-btn">Eliminar Cuenta</button>
				</form>
			</div>
		</section>
	</main>
	<!-- Footer -->
	<footer>
		<div class="footer-content">
			<div class="logo" style="font-size: 2rem; margin-bottom: 1rem;"><i class="fas fa-scissors"></i> GlowBeauty
				Beauty</div>
			<p>Tu belleza es nuestra prioridad</p>

			<div class="footer-grid">
				<div class="footer-section">
					<h3>Navegaci贸n</h3>
					<ul>
						<li><a onclick="showSection('dashboard')">Dashboard</a></li>
						<li><a onclick="showSection('appointments')">Citas</a></li>
						<li><a onclick="showSection('services')">Servicios</a></li>
						<li><a onclick="showSection('profile')">Mi Perfil</a></li>
					</ul>
				</div>

				<div class="footer-section">
					<h3>Legal</h3>
					<ul>
						<li><a href="#">T茅rminos y Condiciones</a></li>
						<li><a href="#">Pol铆tica de Privacidad</a></li>
						<li><a href="#">Pol铆tica de Cancelaci贸n</a></li>
					</ul>
				</div>
				<div class="footer-section">
					<h3>Contacto</h3>
					<div class="contact-info">
						<p><i class="fas fa-map-marker-alt"></i> Fusagasug谩, Cundinamarca</p>
						<p><i class="fas fa-phone"></i> +57 300 123 4567</p>
						<p><i class="fas fa-envelope"></i> info@GlowBeauty.com</p>
						<p><i class="fas fa-clock"></i> Lun-Sab: 9AM-7PM</p>
					</div>
				</div>
			</div>

			<div class="social-links">
				<a href="#"><i class="fab fa-facebook-f"></i></a>
				<a href="#"><i class="fab fa-instagram"></i></a>
				<a href="#"><i class="fab fa-whatsapp"></i></a>
				<a href="#"><i class="fab fa-tiktok"></i></a>
				<a href="#"><i class="fab fa-youtube"></i></a>
			</div>

			<p
				style="margin-top: 1.5rem; padding-top: 1.5rem; border-top: 1px solid rgba(255,255,255,0.3); font-size: 0.9rem;">
				&copy; 2025 GlowBeauty. Todos los derechos reservados. | Hecho con  para ti
			</p>
		</div>
	</footer>


	<div class="modal fade" id="editModal" tabindex="-1" aria-labelledby="editModalLabel" aria-hidden="true">
		<div class="modal-dialog">
			<div class="modal-content">
				<form id="serviceForm" th:action="@{/profesional/actualizar-servicio}" method="post">
					<div class="modal-header">
						<h5 class="modal-title" id="editModalLabel">Editar servicio</h5>
						<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
					</div>

					<div class="modal-body">
						<input type="hidden" id="serviceIdModal" name="id">

						<div class="mb-3">
							<label for="edit-nombre" class="form-label">Nombre</label>
							<input type="text" class="form-control" id="edit-nombre" name="nombre">
						</div>

						<div class="mb-3">
							<label for="edit-descripcion" class="form-label">Descripci贸n</label>
							<textarea class="form-control" id="edit-descripcion" name="descripcion"></textarea>
						</div>

						<div class="mb-3">
							<label for="edit-precio" class="form-label">Precio</label>
							<input type="number" class="form-control" id="edit-precio" name="precio">
						</div>

						<div class="mb-3">
							<label for="edit-duracion" class="form-label">Duraci贸n</label>
							<input type="text" class="form-control" id="edit-duracion" name="duracion">
						</div>
					</div>

					<div class="modal-footer">
						<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
						<button type="submit" class="btn btn-primary">Guardar cambios</button>
					</div>
				</form>
			</div>
		</div>
	</div>

	<script th:src="@{/js/ScripsProfesio.js}"></script>
</body>

</html>